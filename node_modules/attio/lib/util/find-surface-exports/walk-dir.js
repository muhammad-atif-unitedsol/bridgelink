import fs from "fs/promises";
import path from "path";
const EXTENSIONS = ["js", "jsx", "ts", "tsx"];
const EXCLUDE_DIRS = ["node_modules"];
function isSrcFile(filePath) {
    return EXTENSIONS.some((extension) => filePath.endsWith(`.${extension}`));
}
export async function* walkDir(dir) {
    const currentDirFiles = await fs.readdir(dir, { withFileTypes: true });
    const walkSubDirIterators = [];
    for (const file of currentDirFiles) {
        const fullPath = path.join(dir, file.name);
        if (file.isDirectory() && !EXCLUDE_DIRS.includes(file.name)) {
            walkSubDirIterators.push(walkDir(fullPath));
        }
        else if (isSrcFile(fullPath)) {
            yield fullPath;
        }
    }
    for (const walkSubDirIterator of walkSubDirIterators) {
        for await (const filePath of walkSubDirIterator) {
            yield filePath;
        }
    }
}
